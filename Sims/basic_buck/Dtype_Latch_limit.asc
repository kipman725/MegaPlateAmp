Version 4
SHEET 1 1984 908
WIRE 1184 -1184 832 -1184
WIRE 1232 -1184 1184 -1184
WIRE 832 -1152 832 -1184
WIRE 832 -1024 832 -1072
WIRE 1104 -944 -112 -944
WIRE 1232 -944 1168 -944
WIRE 1104 -928 224 -928
WIRE 1232 -880 1232 -944
WIRE 1392 -880 1232 -880
WIRE 1104 -848 640 -848
WIRE 1392 -848 1168 -848
WIRE 1536 -848 1456 -848
WIRE 1568 -848 1536 -848
WIRE 1104 -816 1056 -816
WIRE -144 -656 -400 -656
WIRE 192 -656 -64 -656
WIRE 576 -656 256 -656
WIRE 1040 -656 720 -656
WIRE -400 -560 -400 -656
WIRE -368 -560 -400 -560
WIRE -112 -560 -112 -944
WIRE -112 -560 -208 -560
WIRE -64 -560 -64 -656
WIRE -32 -560 -64 -560
WIRE 224 -560 224 -928
WIRE 224 -560 128 -560
WIRE 256 -560 256 -656
WIRE 320 -560 256 -560
WIRE 640 -560 640 -848
WIRE 640 -560 480 -560
WIRE 720 -560 720 -656
WIRE 784 -560 720 -560
WIRE 1056 -560 1056 -816
WIRE 1056 -560 944 -560
WIRE -368 -512 -576 -512
WIRE -144 -512 -144 -656
WIRE -144 -512 -192 -512
WIRE -112 -512 -144 -512
WIRE -32 -512 -112 -512
WIRE 192 -512 192 -656
WIRE 192 -512 144 -512
WIRE 224 -512 192 -512
WIRE 320 -512 224 -512
WIRE 576 -512 576 -656
WIRE 576 -512 496 -512
WIRE 688 -512 576 -512
WIRE 784 -512 688 -512
WIRE 1024 -512 960 -512
WIRE 1040 -512 1040 -656
WIRE 1040 -512 1024 -512
WIRE 1120 -512 1120 -528
WIRE 1120 -512 1040 -512
WIRE -112 -480 -112 -512
WIRE 688 -480 688 -512
WIRE 1024 -480 1024 -512
WIRE 224 -464 224 -512
WIRE -576 -448 -576 -512
WIRE -112 -368 -112 -400
WIRE 224 -368 224 -384
WIRE 224 -368 -112 -368
WIRE 688 -368 688 -400
WIRE 688 -368 224 -368
WIRE 1024 -368 1024 -400
WIRE 1024 -368 688 -368
WIRE 1152 -368 1024 -368
WIRE 1152 -352 1152 -368
WIRE -576 -336 -576 -368
WIRE 160 112 -720 112
WIRE 320 112 256 112
WIRE 528 112 320 112
WIRE 624 112 528 112
WIRE 784 112 704 112
WIRE 976 112 784 112
WIRE 528 192 528 112
WIRE 240 208 240 160
WIRE 784 208 784 112
WIRE 976 224 976 112
WIRE 240 304 240 288
WIRE -496 320 -592 320
WIRE -368 320 -496 320
WIRE -96 320 -208 320
WIRE 192 320 -32 320
WIRE -592 336 -592 320
WIRE -96 336 -128 336
WIRE 528 336 528 256
WIRE 592 336 528 336
WIRE 624 336 592 336
WIRE 736 336 704 336
WIRE 784 336 784 272
WIRE 784 336 736 336
WIRE 976 336 976 304
WIRE 976 336 784 336
WIRE 528 352 528 336
WIRE -368 368 -464 368
WIRE 192 368 176 368
WIRE 176 384 176 368
WIRE 240 416 240 384
WIRE 320 416 320 112
WIRE 320 416 240 416
WIRE 928 416 816 416
WIRE 1008 416 928 416
WIRE 1136 416 1088 416
WIRE -720 432 -720 112
WIRE 816 448 816 416
WIRE 1136 448 1136 416
WIRE 736 464 736 336
WIRE 768 464 736 464
WIRE -176 496 -224 496
WIRE -128 496 -128 336
WIRE -128 496 -176 496
WIRE 592 512 592 336
WIRE 768 512 592 512
WIRE -720 544 -720 512
WIRE -592 544 -592 416
WIRE 816 544 816 528
WIRE 1136 544 1136 512
WIRE -288 592 -288 416
WIRE -288 592 -448 592
WIRE -512 608 -640 608
WIRE -640 704 -640 608
WIRE -688 720 -752 720
WIRE -752 736 -752 720
WIRE -720 768 -752 768
WIRE -688 768 -720 768
WIRE -640 848 -640 784
WIRE -640 848 -736 848
FLAG -720 544 0
FLAG 528 352 0
FLAG 176 384 0
FLAG -592 544 0
FLAG -576 -336 0
FLAG 816 544 0
FLAG 928 416 Isense
FLAG -736 848 Isense
FLAG 1120 -528 fs
FLAG -464 368 fs
FLAG 1152 -352 0
FLAG -496 320 logic_1
FLAG -752 736 0
FLAG 1536 -848 blank
FLAG 832 -1024 0
FLAG 1184 -1184 ramp
FLAG -176 496 blank
FLAG -720 768 ramp
FLAG 1136 544 0
SYMBOL nmos 160 160 R270
SYMATTR InstName M1
SYMATTR Value BSZ0920NS
SYMBOL voltage -576 -464 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName 16fs
SYMATTR Value PULSE(0 1 0 10n 10n 312.5n 625n)
SYMBOL voltage -720 416 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 10
SYMBOL res 960 208 R0
SYMATTR InstName R1
SYMATTR Value 3
SYMBOL res 224 192 R0
SYMATTR InstName R2
SYMATTR Value 5
SYMBOL schottky 544 256 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D1
SYMATTR Value RBR5L40A
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL ind 608 128 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=0.115 Cpar=7.036p
SYMBOL cap 768 208 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMATTR SpiceLine Rser=1m
SYMBOL res 720 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 100m
SYMBOL Digital\\dflop -288 272 R0
WINDOW 3 8 12 Left 2
WINDOW 123 8 40 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A1
SYMBOL e 240 288 R0
SYMATTR InstName E1
SYMATTR Value 5
SYMBOL voltage -592 320 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 1
SYMBOL e 816 432 R0
SYMATTR InstName E2
SYMATTR Value 10
SYMBOL Digital\\schmitt -512 544 R0
WINDOW 3 8 44 Left 2
WINDOW 123 8 72 Left 2
SYMATTR Value vt=1
SYMATTR Value2 vh=0.01
SYMATTR InstName A2
SYMBOL Digital\\dflop -288 -608 R0
WINDOW 3 8 12 Left 2
WINDOW 123 8 40 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A3
SYMBOL res -128 -496 R0
SYMATTR InstName R4
SYMATTR Value 10k
SYMBOL res 208 -480 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 672 -496 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 1008 -496 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL Digital\\and 1136 -896 R0
SYMATTR InstName A7
SYMBOL Digital\\and 1136 -992 R0
SYMATTR InstName A8
SYMBOL Digital\\and 1424 -928 R0
SYMATTR InstName A9
SYMBOL Digital\\and -64 272 R0
WINDOW 3 16 52 Left 2
WINDOW 123 16 80 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A10
SYMBOL Digital\\dflop 48 -608 R0
WINDOW 3 8 12 Left 2
WINDOW 123 8 40 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A4
SYMBOL Digital\\dflop 400 -608 R0
WINDOW 3 8 12 Left 2
WINDOW 123 8 40 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A5
SYMBOL Digital\\dflop 864 -608 R0
WINDOW 3 8 12 Left 2
WINDOW 123 8 40 Left 2
SYMATTR Value trise=10n
SYMATTR Value2 tfall=10n
SYMATTR InstName A6
SYMBOL e -640 688 R0
SYMATTR InstName E3
SYMATTR Value 1
SYMBOL voltage 832 -1168 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value PULSE(0 0.52 625n 9.99u 10n 0 10u)
SYMBOL res 1104 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value 10k
SYMBOL cap 1120 448 R0
SYMATTR InstName C2
SYMATTR Value 15.9nF
TEXT -120 -56 Left 2 !.tran 0 10m 1u 10n
TEXT 1224 -800 Left 2 ;Blanking pulse prevents >0.9375 duty cycle\nand resets the ramp compensating ramp generator\nPulse happens in final 1/16th of switching period
TEXT -824 -392 Left 2 ;100kHz buck
TEXT 832 -1248 Left 2 ;Compensating ramp generator
TEXT 992 -1120 Left 2 ;Ramp voltage set for D=0.7V from NXP datasheet
